unit DataEditorForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Vcl.Grids, Vcl.DBGrids,
  Data.Win.ADODB, Vcl.StdCtrls;

type
  TForm5 = class(TForm)
    DBGrid1: TDBGrid;
    ADOConnection1: TADOConnection;
    ADOQuery1: TADOQuery;
    DataSource1: TDataSource;
    EditDate: TEdit;
    LabelDate: TLabel;
    LabelRequesterName: TLabel;
    EditRequesterName: TEdit;
    LabelStatus: TLabel;
    ComboBoxStatus: TComboBox;
    ComboBoxType: TComboBox;
    LabelType: TLabel;
    MemoDescription: TMemo;
    LabelDescription: TLabel;
    ButtonDataChange: TButton;
    ButtonDataDelete: TButton;
    ADOQuery1description: TWideMemoField;
    procedure DBGrid1CellClick(Column: TColumn);
    procedure FormCreate(Sender: TObject);
    procedure ADOQuery1descriptionGetText(Sender: TField; var Text: string;
      DisplayText: Boolean);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form5: TForm5;

implementation

{$R *.dfm}

procedure TForm5.ADOQuery1descriptionGetText(Sender: TField; var Text: string;
  DisplayText: Boolean);
begin
  if Sender.IsNull then
    Text := ''
  else
    Text := Copy(Sender.AsString, 1, 50);
end;

procedure TForm5.DBGrid1CellClick(Column: TColumn);
var
  DBStatus, DBRequestType: Integer;
begin
  if ADOQuery1.FieldByName('id').IsNull then
  begin
    Exit;
  end;

  EditDate.Text := ADOQuery1.FieldByName('request_date').AsString;
  EditRequesterName.Text := ADOQuery1.FieldByName('requester_name').AsString;

  DBStatus := ADOQuery1.FieldByName('status').AsInteger;
  DBRequestType := ADOQuery1.FieldByName('request_type').AsInteger;

  ComboBoxStatus.ItemIndex := ComboBoxStatus.Items.IndexOfObject(TObject(DBStatus));
  ComboBoxType.ItemIndex := ComboBoxType.Items.IndexOfObject(TObject(DBRequestType));

  MemoDescription.Text := ADOQuery1.FieldByName('description').AsString;
end;

procedure TForm5.FormCreate(Sender: TObject);
begin
  ComboBoxStatus.Items.AddObject('Активен', TObject(0));
  ComboBoxStatus.Items.AddObject('Закрыт', TObject(1));

  ComboBoxType.Items.AddObject('Техническая', TObject(0));
  ComboBoxType.Items.AddObject('Административная', TObject(1));

end;

end.
